<!--
   Licensed to the Apache Software Foundation (ASF) under one or more
   contributor license agreements.  See the NOTICE file distributed with
   this work for additional information regarding copyright ownership.
   The ASF licenses this file to You under the Apache License, Version 2.0
   (the "License"); you may not use this file except in compliance with
   the License.  You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-  2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.
-->
<html>




























<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="description" content="Apache Shiro is a powerful and easy-to-use Java security framework that performs authentication, authorization, cryptography, and session management.">
    <meta name="google-site-verification" content="QIax6uT5UX3enoU0G8Pz2pXbQ45KaQuHZ3nCh9V27mw">
    <meta name="google-site-verification" content="ecFap6dWJgS_GCCtxmJQJ_nFYQhM6EgSpBPZDU7xsCE">
    <meta name="msvalidate.01" content="0B57EB46CBFAD8FD45008D2DB6B6C68C">
    <meta name="y_key" content="e47896cd6bae4920">
    <link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml">

    <title>
                    Apache Shiro | Simple. Java. Security.
        </title>


    <link rel="icon" type="image/vnd.microsoft.icon" href="./assets/images/favicon.ico">
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">

    <!-- site styles and  -->
    <link rel="stylesheet" type="text/css" href="./assets/css/style.css">
    <script type="text/javascript" src="./assets/js/shiro-site.js"></script>

    <!-- github ribbon -->
    <link rel="stylesheet" href="./assets/css/gh-pages/gh-fork-ribbon.css" />
    <!--[if lt IE 9]>
      <link rel="stylesheet" href="./assets/css/gh-pages/gh-fork-ribbon.ie.css" />
    <![endif]-->

    <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>

    <!-- bootstrap -->
    <link rel="stylesheet" href="./assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="./assets/bootstrap/css/bootstrap-theme.min.css">
    <script src="./assets/bootstrap/js/bootstrap.min.js"></script>

    <link rel="stylesheet" href="./assets/css/bootstrap-social.css">

    <!-- Google Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXX-Y', 'auto');
    ga('send', 'pageview');
    </script>
    <!-- End Google Analytics -->



    <!-- syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.7.0/styles/default.min.css" integrity="sha256-Zd1icfZ72UBmsId/mUcagrmN7IN5Qkrvh75ICHIQVTk=" crossorigin="anonymous" />
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.7.0/highlight.min.js" integrity="sha256-s63qpgPYoQk+wv3U6WZqioVJrwFNBTgD4dkeegLuwvo=" crossorigin="anonymous"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <script type="text/javascript">

        $( document ).ready(function() {
            addPageEditLink();
        });
    </script>
</head>

<body>

    <div id="top-bar"></div>

    <div class="container" style="max-width: 1200px;">

    <a class="github-fork-ribbon right-top" href="https://github.com/apache/shiro" title="Fork me on GitHub">Fork me on GitHub</a>



    <div class="masthead">
        <p class="lead">
            <a href="./index.html">
                <img src="./assets/images/apache-shiro-logo.png" style="height:100px; width:auto; vertical-align: bottom; margin-top: 20px;">
            </a>
            <span class="tagline">Simple. Java. Security.</span>
            <a class="pull-right" href="https://www.apache.org/events/current-event.html">
                <img style="padding-top: 8px" src="https://www.apache.org/events/current-event-125x125.png"/>
            </a>
        </p>
    </div>



    <nav class="navbar navbar-default" role="navigation">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse"
                    data-target="#navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="navbar-collapse-1">
            <ul class="nav navbar-nav">
                <li><a href="./get-started.html">Get Started</a></li>
                <li><a href="./documentation.html">Docs</a></li>

                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                        Web Apps <b class="caret"></b>
                    </a>

                    <ul class="dropdown-menu">
                        <li><a href="./web.html">General</a></li>
                        <li class="divider"></li>
                        <li><a href="./web-features.html">Features</a></li>
                    </ul>
                </li>

                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                        Integrations <b class="caret"></b>
                    </a>

                    <ul class="dropdown-menu">
                        <li><a href="./spring-boot.html">Spring</a></li>
                        <li><a href="./guice.html">Guice</a></li>
                        <li class="divider"></li>
                        <li><a href="./integration.html">Third-Party Integrations</a></li>
                    </ul>
                </li>

                <li><a href="./features.html">Features</a></li>

                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                        Community <b class="caret"></b>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="./forums.html">Community Forums</a></li>
                        <li><a href="./mailing-lists.html">Mailing Lists</a></li>
                        <li><a href="./articles.html">Articles</a></li>
                        <li><a href="./news.html">News</a></li>
                        <li><a href="./events.html">Events</a></li>
                        <li class="divider"></li>
                        <li><a href="./community.html">More</a></li>
                    </ul>
                </li>

                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                        About <b class="caret"></b>
                    </a>

                    <ul class="dropdown-menu">
                        <li><a href="./about.html">About</a></li>
                        <li><a href="./security-reports.html">Vulnerability Reports</a></li>
                    </ul>
                </li>

            </ul>

            <ul class="nav navbar-nav navbar-right">
                <li class="dropdown">
                    <a href="http://www.apache.org/" class="dropdown-toggle" data-toggle="dropdown">
                        Apache Software Foundation <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li><a href="http://www.apache.org/">Apache Homepage</a></li>
                        <li><a href="http://www.apache.org/licenses/">License</a></li>
                        <li><a href="http://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
                        <li><a href="http://www.apache.org/foundation/thanks.html">Thanks</a></li>
                        <li><a href="http://www.apache.org/security/">Security</a></li>
                    </ul>
                </li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </nav>


            

<!-- spacer allows enough room to display the header -->
<div id="spacer" style="width: 0; height: 200px; float: left"></div>

<!-- related content (if any) -->
    <div style="border-style: solid; border-width: 2px; border-color: navy; padding: 5px; margin-left: 20px; margin-bottom: 20px; width:275px; float: right; clear: both; ">
      <h2>Related Content</h2>
                    <h3><a href="authentication-features.html">Authentication Features</a></h3>
            <p>Quick overview of easy, subject-based authentication in Shiro.</br><span style="font-size:11"><a href="authentication-features.html">Read More &gt;&gt;</a></span></p>
                    <h3><a href="authentication.html">Authentication Docs</a></h3>
            <p>Full documentation on Shiro's Authentication functionality.</br><span style="font-size:11"><a href="authentication.html">Read More &gt;&gt;</a></span></p>
                    <h3><a href="10-minute-tutorial.html">10-Minute Shiro Tutorial</a></h3>
            <p>Try Apache Shiro for yourself in under 10 minutes.</br><span style="font-size:11"><a href="10-minute-tutorial.html">Read More &gt;&gt;</a></span></p>
                    <h3><a href="webapp-tutorial.html">Web App Tutorial</a></h3>
            <p>Step-by-step tutorial for securing a web application with Shiro.</br><span style="font-size:11"><a href="webapp-tutorial.html">Read More &gt;&gt;</a></span></p>
          </div>
  <a name="JavaAuthenticationGuide-JavaAuthenticationGuidewithApacheShiro"></a>
<h1><a href="#java-authentication-guide-with-apache-shiro" name="java-authentication-guide-with-apache-shiro">Java Authentication Guide with Apache Shiro</a></h1>
<p>Authentication is the process of identity verification&ndash; you are trying to prove a user is who they say they are. To do so, a user needs to provide some sort of proof of identity that your system understands and trust.</p>
<p>The goal of this guide is to walk you through how Authentication in Java is performed in Shiro. If you haven&rsquo;t already please take moment and go through Shiro&rsquo;s <a href="10-minute-tutorial.html" title="10 Minute Tutorial">10 Minute Tutorial</a> so that you get a basic understanding of how to work with Shiro.</p>
<a name="JavaAuthenticationGuide-Terminologyyou%27llneed"></a>
<h2>Terminology you&rsquo;ll need</h2>
<ul>
  <li>
  <p><strong>Subject</strong> - Security specific user &lsquo;view&rsquo; of an application user. It can be a human being, a third-party process, a server connecting to you application, or even a cron job. Basically, it is anything or anyone communicating with your application.</p></li>
  <li>
  <p><strong>Principals</strong> - A subjects identifying attributes. First name, last name, social security number, username</p></li>
  <li>
  <p><strong>Credentials</strong> - secret data that are used to verify identities. Passwords, Biometric data, x509 certificates,</p></li>
  <li>
  <p><strong>Realms</strong> - Security specific DAO, data access object, software component that talks to a backend data source. If you have usernames and password in LDAP, then you would have an LDAP Realm that would communicate with LDAP. The idea is that you would use a realm per back-end data source and Shiro would know how to coordinate with these realms together to do what you have to do.</p></li>
</ul>
<a name="JavaAuthenticationGuide-HowtoAuthenticateinJavawithShiro"></a>
<h2><a href="#how-to-authenticate-in-java-with-shiro" name="how-to-authenticate-in-java-with-shiro">How to Authenticate in Java with Shiro</a></h2>
<p>In Shiro&rsquo;s framework, and most every other framework for that matter, the Java authentication process can be broken up into three distinct steps.</p>
<a name="JavaAuthenticationGuide-Steps"></a>
<h3><a href="#steps" name="steps">Steps</a></h3>
<ol>
  <li>Collect the subject&rsquo;s principals and credentials</li>
  <li>Submit the principals and credentials to an authentication system.</li>
  <li>Allow access, retry authentication, or block access</li>
</ol>
<p>Here is some code on how you do this in Shiro Specifically.</p>
<a name="JavaAuthenticationGuide-Step1Collectthesubject%27sprincipalsandcredentials"></a>
<h3>Step 1 - Collect the subject&rsquo;s principals and credentials</h3>
<pre><code class="java">//Example using most common scenario: 
//String username and password.  Acquire in 
//system-specific manner (HTTP request, GUI, etc)
UsernamePasswordToken token = new UsernamePasswordToken( username, password );

//”Remember Me” built-in, just do this: 
token.setRememberMe(true);
</code></pre>
<p>In this particular case, we’re using a class called <a href="static/current/apidocs/org/apache/shiro/authc/UsernamePasswordToken.html">UsernamePasswordToken</a>. It is the most common authentication token used in the framework.</p>
<p>We use this token to bundle the username and password we acquired in someway in our Java application. Maybe they were submitted via a user web form, an HTTP header, or a command line. In Shiro, it does not matter how you acquire them&ndash; it is protocol agnostic.</p>
<p>In this example, we have decided that we want the application to remember users when they return. So once the token is created, we use Shiro&rsquo;s built-in &ldquo;Remember-me&rdquo; feature by setting it to true on the token. This is done using the token&rsquo;s <a href="static/current/apidocs/org/apache/shiro/authc/UsernamePasswordToken.html#setRememberMe-boolean-"><code>setRememberMe()</code></a> method</p>
<a name="JavaAuthenticationGuide-Step2Submittheprincipalsandcredentialstoanauthenticationsystem."></a>
<h3>Step 2 - Submit the principals and credentials to an authentication system.</h3>
<p>So we’ve collected the information in a token and set it to remember returning users. The next step is in the Authentication process is to submit the token to an authentication system. Your authentication system is represented in Shiro by security-specific DAOs, that are referred to as <a href="static/current/apidocs/">Realms</a>. For more information on realms please check out the <a href="realm.html">Shiro Realm Guide</a>.</p>
<p>In Shiro we try to make this part as quick and easy as humanly possible. We have it down to one line of Java code!</p>
<pre><code class="java">//With most of Shiro, you&#39;ll always want to make sure you&#39;re working with the currently 
//executing user, referred to as the subject 
Subject currentUser = SecurityUtils.getSubject();

//Authenticate the subject by passing 
//the user name and password token 
//into the login method 
currentUser.login(token);
</code></pre>
<p>First, we need to acquire the currently executing user, referred to as the subject. A subject is just a security specific view of the user&mdash;-it can be a human, a process, cron job, doesn&rsquo;t matter. In Shiro, there is always a subject instance available to the currently executing thread. The concept of a subject is core to Shiro and most of the framework is centered around working with subjects. In this example, we will name this instance of subject currentUser.</p>
<p>To acquire the subject, we use the <a href="static/current/apidocs/org/apache/shiro/SecurityUtils.html">SecurityUtils</a> class which is also a core part of Shiro&rsquo;s API. It will acquire the currently executing user via the <a href="static/current/apidocs/org/apache/shiro/SecurityUtils.html#getSubject--"><code>getsubject()</code></a> method call. And we get back a subject instance that is representing who the current user is who is interacting with the system. At this point in the example, the subject currentUser is anonymous. There is no identity associated with them.</p>
<p>Now with the user representation in hand, we authenticate them by just calling the <a href="static/current/apidocs/org/apache/shiro/subject/Subject.html#login-org.apache.shiro.authc.AuthenticationToken-"><code>login()</code></a>) method and submit the token we just constructed a second ago.</p>
<a name="JavaAuthenticationGuide-Step3Allowaccess%2Cretryauthentication%2Corblockaccess"></a>
<h3>Step 3 - Allow access, retry authentication, or block access</h3>
<p>Again really, really easy, single method call. If the <code>login()</code> method call is successful, then the user is logged in and associated with a user account or identity. From here, the user can go about using your application and retain their identity through their session or longer since we have set the &ldquo;Remember Me&rdquo; in our example.</p>
<p>But what happens if something fails in the authentication attempt? What if they give you the wrong password or they accessed the system too many times, maybe their account is locked? In this case, Shiro will throw an exception. This is where Shiro&rsquo;s rich exception hierarchy comes into play.</p>
<pre><code class="java">try {
    currentUser.login(token);
} catch  ( UnknownAccountException uae ) { ...
} catch  ( IncorrectCredentialsException ice ) { ...
} catch  ( LockedAccountException lae ) { ...
} catch  ( ExcessiveAttemptsException eae ) { ...
} ...  your own ...
} catch ( AuthenticationException ae ) {
    //unexpected error?
}
//No problems, show authenticated view…
</code></pre>
<p>You can take that method call and wrap it in a try/catch block and you can catch all sort of exceptions if you want to handle them and react accordingly. In addition to a rich set of exceptions that Shiro offers, you can create your own if you need custom functionality. For more information, follow this link documentation on <a href="static/current/apidocs/org/apache/shiro/authc/AuthenticationException.html">AuthenticationException</a>.</p>
<div class="alert alert-success">
    <span class="glyphicon glyphicon-ok"></span> <strong>Security Tip</strong>
    <hr class="message-inner-separator">
    <p>Security best practice is to give generic login failure messages to users because you do not want to aid an attacker trying to break into your system.</p>
</div>
<a name="JavaAuthenticationGuide-%22RememberMe%22Support"></a>
<h2>&ldquo;Remember Me&rdquo; Support</h2>
<p>As shown in the example above, Shiro supports the notion of &ldquo;remember me&rdquo; in addition to the normal login process.  </p>
<p>In Shiro, the Subject object supports two methods : <a href="static/current/apidocs/org/apache/shiro/subject/Subject.html#isRemembered--"><code>isRemembered()</code></a> and <a href="static/current/apidocs/org/apache/shiro/subject/Subject.html#isAuthenticated--"><code>isAuthenticated()</code></a>.</p>
<p>A &ldquo;remembered&rdquo; subject has an identity (it is not anonymous) and their identifying attributes,referred to as principals, are remembered from a successful authentication during a previous session.</p>
<p>An authenticated subject has proved their identity <em>during their current session</em>.</p>
<div class="alert alert-danger">
    <span class="glyphicon glyphicon-exclamation-sign"></span> <strong>Warning</strong>
    <hr class="message-inner-separator">
    <p>If a subject is remembered, it DOES NOT mean they are authenticated.</p>
</div>
<a name="JavaAuthenticationGuide-RememberedvsAuthenticated"></a>
<h3><a href="#remembered-vs-authenticated" name="remembered-vs-authenticated">Remembered vs Authenticated</a></h3>
<p>In shiro it is very important to note that a remembered subject is not an authenticated subject. A check against <code>isAuthenticated()</code> is a much more strict check because authentication is the process of proving you are who you say you are. When a user is only remembered, the remembered identity gives the system an idea who that user probably is, but in reality, has no way of absolutely guaranteeing if the remembered Subject represents the user currently using the application. Once the subject is authenticated, they are no longer considered only remembered because their identity would have been verified during the current session.</p>
<p>So although many parts of the application can still perform user-specific logic based on the remembered principals, such as customized views, it should never perform highly-sensitive operations until the user has legitimately verified their identity by executing a successful authentication attempt.</p>
<p>For example, a check to see if a subject can access financial information should almost always depend on <code>isAuthenticated()</code>, not <code>isRemembered()</code>, to guarantee a verified identity.</p>
<p>Here is a scenario to help illustrate why the distinction between isAuthenticated and isRemembered is important.</p>
<p>Let&rsquo;s say you&rsquo;re using Amazon.com. You log in and you add some books to your shopping cart. A day goes by. Of course your user session has expired and you&rsquo;ve been logged out. But Amazon &ldquo;remembers&rdquo; you, greets you by name, and is still giving you personalized book recommendations. To Amazon, <code>isRemembered()</code> would return <code>TRUE</code>. What happens if you try to use one of the credit cards on file or change your account information? While Amazon &ldquo;remembers&rdquo; you, <code>isRemembered() = TRUE</code>, it is not certain that you are in fact you, <code>isAuthenticated()=FALSE</code>. So before you can perform a sensitive action Amazon needs to verify your identity by forcing an authentication process which it does through a login screen. After the login, your identity has been verified and <code>isAuthenticated()=TRUE</code>.</p>
<p>This scenario happens very often over the web so the functionality is built into Shiro helping you easily make the distinction yourself.</p>
<a name="JavaAuthenticationGuide-LoggingOut"></a>
<h2><a href="#logging-out" name="logging-out">Logging Out</a></h2>
<p>Finally, when the user is done using the application, they can log out. And in Shiro, we make logging out quick and easy with a single method call.</p>
<pre><code class="java">currentUser.logout(); //removes all identifying information and invalidates their session too.
</code></pre>
<p>When you log out in Shiro it will close out the user session and removes any associated identity from the subject instance. If you&rsquo;re using RememberMe in a web environment, then <code>.logout()</code> will, by default, also delete the RememberMe cookie from the browser.</p>
<h2><a name="Lendahandwithdocumentation"></a>Lend a hand with documentation </h2>
<p>While we hope this documentation helps you with the work you're doing with Apache Shiro, the community is improving and expanding the documentation all the time.  If you'd like to help the Shiro project, please consider correcting, expanding, or adding documentation where you see a need. Every little bit of help you provide expands the community and in turn improves Shiro. </p>
<p>The easiest way to contribute your documentation is to submit a pull-request by clicking on the <code>Edit</code> link below, send it to the <a class="external-link" href="http://shiro-user.582556.n2.nabble.com/" rel="nofollow">User Forum</a> or the <a href="mailing-lists.html" title="Mailing Lists">User Mailing List</a>.</p>
<input type="hidden" id="ghEditPage" value="java-authentication-guide.md.vtl"></input>    
</div>

    <div class="footer-padding"></div>
    <footer class="custom-footer">

        <div class="col-md-5">
            <div class="copyright-footer">
            <a href="http://www.apache.org/foundation/contributing.html">Donate to the ASF</a> |
            <a href="http://www.apache.org/licenses/LICENSE-2.0.html">License</a>
            <p>Copyright &copy; 2008-2020 The Apache Software Foundation</p>
                </div>
        </div>

        <div class="social col-md-2">
            <a class="btn btn-social-icon btn-sm btn-twitter" target="_blank" href="https://twitter.com/ApacheShiro"><span class="fa fa-twitter"></span></a>
            <a class="btn btn-social-icon btn-sm btn-facebook" target="_blank" href="https://www.facebook.com/ApacheShiro"><span class="fa fa-facebook"></span></a>
            <a class="btn btn-social-icon btn-sm btn-linkedin" target="_blank" href="https://www.linkedin.com/groups/4382576"><span class="fa fa-linkedin"></span></a>
        </div>


        <div class="col-md-2"></div>
        <div class="col-md-2 editThisPage">
            <div class="footer-shield"></div>
        </div>

    </footer> <!--END FOOTER-->

</body>
</html>
